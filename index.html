<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
  const map = L.map('map').setView([-17.3949, -66.1568], 14);

  // Mapa base de OpenStreetMap
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '¬© OpenStreetMap'
  }).addTo(map);

  // üìç Nodo fijo
  const nodoCoords = [-17.3949, -66.1568];
  const nodo = L.marker(nodoCoords).addTo(map);
  nodo.bindPopup(`
    <strong>NODO TUNARI</strong><br>
    VER LOS PLANES<br>
    Contacto: 77445566
  `).openPopup();

  let linea = null;

  // üîç Medir distancia desde el nodo al punto clickeado
  map.on('click', function (e) {
    const destino = e.latlng;

    // Quitar l√≠nea anterior si existe
    if (linea) {
      map.removeLayer(linea);
    }

    // Dibujar nueva l√≠nea
    linea = L.polyline([nodoCoords, [destino.lat, destino.lng]], {
      color: 'blue',
      weight: 3
    }).addTo(map);

    // Calcular distancia
    const distancia = map.distance(nodoCoords, destino);
    alert(`Distancia desde el nodo: ${(distancia / 1000).toFixed(3)} km`);
  });
</script>
